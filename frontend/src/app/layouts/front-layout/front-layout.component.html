<div class="min-h-screen futuristic-layout">
  <!-- Header futuriste -->
  <header class="fixed top-0 left-0 right-0 futuristic-header z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <!-- Logo and main nav (left side) -->
        <div class="flex items-center">
          <!-- Mobile menu button -->
          <button
            (click)="toggleSidebar()"
            class="md:hidden text-gray-500 hover:text-gray-700 focus:outline-none"
            aria-label="Toggle menu"
          >
            <svg
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"
              />
            </svg>
          </button>

          <!-- Logo futuriste -->
          <a routerLink="/" class="flex-shrink-0 flex items-center">
            <h1 class="text-xl font-bold futuristic-logo">DevBridge</h1>
            <span class="ml-2 text-sm futuristic-subtitle hidden md:block"
              >Project Management Suite</span
            >
          </a>

          <!-- Navigation futuriste -->
          <nav class="hidden md:ml-6 md:flex md:space-x-8">
            <a
              routerLink="/"
              class="futuristic-nav-link"
              routerLinkActive="futuristic-nav-link-active"
              >Accueil</a
            >

            <a
              routerLink="/plannings"
              class="futuristic-nav-link"
              routerLinkActive="futuristic-nav-link-active"
              >Plannings</a
            >

            <a
              routerLink="/reunions"
              class="futuristic-nav-link"
              routerLinkActive="futuristic-nav-link-active"
              >Réunions</a
            >

            <a
              routerLink="/messages"
              class="futuristic-nav-link"
              routerLinkActive="futuristic-nav-link-active"
              >Messages</a
            >

            <a
              routerLink="/notifications"
              class="futuristic-nav-link relative"
              routerLinkActive="futuristic-nav-link-active"
            >
              Notifications
              <span
                *ngIf="unreadNotificationsCount > 0"
                class="futuristic-badge absolute right-4 inline-flex items-center justify-center"
              >
                {{
                  unreadNotificationsCount > 9 ? "9+" : unreadNotificationsCount
                }}
              </span>
            </a>
          </nav>
        </div>

        <!-- Right side -->
        <div class="flex items-center">
          <ng-container *ngIf="authService.userLoggedIn(); else authButtons">
            <div class="ml-4 flex items-center md:ml-6">
              <!-- Profile dropdown -->
              <div class="relative">
                <button
                  (click)="toggleProfileMenu()"
                  class="futuristic-profile-button"
                  [attr.aria-expanded]="profileMenuOpen"
                  aria-haspopup="true"
                >
                  <span class="sr-only">Open user menu</span>
                  <span
                    class="hidden md:inline-block mr-2 text-sm font-medium futuristic-username"
                  >
                    {{
                      currentUser?.username ||
                        authService.getCurrentUser()?.username
                    }}
                  </span>
                  <div class="futuristic-avatar">
                    <img
                      [src]="
                        currentUser?.image ||
                        authService.getCurrentUser()?.image ||
                        'assets/images/default-profile.png'
                      "
                      alt="Profile"
                    />
                  </div>
                </button>

                <!-- Menu déroulant du profil futuriste -->
                <div
                  *ngIf="profileMenuOpen"
                  class="futuristic-dropdown-menu"
                  role="menu"
                  aria-orientation="vertical"
                  aria-labelledby="user-menu"
                >
                  <a
                    routerLink="/profile"
                    (click)="profileMenuOpen = false"
                    class="futuristic-dropdown-item"
                    role="menuitem"
                  >
                    <i class="fas fa-user mr-2"></i>
                    Mon profil
                  </a>

                  <a
                    (click)="logout()"
                    class="futuristic-dropdown-item"
                    role="menuitem"
                  >
                    <i class="fas fa-sign-out-alt mr-2"></i>
                    Déconnexion
                  </a>
                </div>
              </div>
            </div>
          </ng-container>

          <ng-template #authButtons>
            <div class="flex space-x-4">
              <a routerLink="/loginuser" class="futuristic-login-button">
                <i class="fas fa-sign-in-alt mr-2"></i>
                Connexion
              </a>
              <a routerLink="/registeruser" class="futuristic-register-button">
                <i class="fas fa-user-plus mr-2"></i>
                Inscription
              </a>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </header>

  <!-- Barre latérale mobile futuriste -->
  <div
    class="fixed inset-0 z-40 md:hidden"
    [class.hidden]="!sidebarOpen"
    (click)="sidebarOpen && toggleSidebar()"
  >
    <!-- Contenu de la barre latérale -->
    <div
      class="fixed inset-y-0 left-0 max-w-xs w-full futuristic-sidebar transform transition-transform duration-300 ease-in-out"
      [class.translate-x-0]="sidebarOpen"
      [class.-translate-x-full]="!sidebarOpen"
      (click)="$event.stopPropagation()"
    >
      <div class="flex flex-col h-full">
        <!-- En-tête de la barre latérale futuriste -->
        <div
          class="flex items-center justify-between px-4 py-3 futuristic-sidebar-header"
        >
          <div>
            <h3 class="text-xl font-bold futuristic-logo">DevBridge</h3>
            <p class="text-sm futuristic-subtitle">Project Management Suite</p>
          </div>
          <button
            (click)="toggleSidebar()"
            class="futuristic-close-button"
            aria-label="Close menu"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>

        <!-- Navigation de la barre latérale futuriste -->
        <nav
          class="flex-1 px-2 py-4 space-y-1 overflow-y-auto futuristic-sidebar-nav"
        >
          <a
            *ngFor="
              let item of [
                {
                  route: '/',
                  icon: 'M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6',
                  text: 'Accueil'
                },
                {
                  route: '/plannings',
                  icon: 'M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2',
                  text: 'Plannings'
                },
                {
                  route: '/reunions',
                  icon: 'M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z',
                  text: 'Réunions'
                },
                {
                  route: '/messages',
                  icon: 'M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z',
                  text: 'Messages'
                },
                {
                  route: '/notifications',
                  icon: 'M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z',
                  text: 'Notifications',
                  badge: unreadNotificationsCount
                }
              ]
            "
            routerLink="{{ item.route }}"
            (click)="toggleSidebar()"
            class="futuristic-sidebar-link"
            routerLinkActive="futuristic-sidebar-link-active"
          >
            <svg
              class="futuristic-sidebar-icon"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                attr.d="{{ item.icon }}"
              />
            </svg>
            {{ item.text }}
            <span
              *ngIf="item.badge && item.badge > 0"
              class="futuristic-badge absolute right-4"
            >
              {{ item.badge > 9 ? "9+" : item.badge }}
            </span>
          </a>

          <div class="futuristic-separator my-2"></div>

          <ng-container *ngIf="!authService.userLoggedIn()">
            <a
              routerLink="/loginuser"
              (click)="toggleSidebar()"
              class="futuristic-sidebar-link"
            >
              <i class="fas fa-sign-in-alt futuristic-sidebar-icon-fa"></i>
              Connexion
            </a>

            <a
              routerLink="/registeruser"
              (click)="toggleSidebar()"
              class="futuristic-sidebar-link"
            >
              <i class="fas fa-user-plus futuristic-sidebar-icon-fa"></i>
              Inscription
            </a>
          </ng-container>

          <ng-container *ngIf="authService.userLoggedIn()">
            <a
              routerLink="/profile"
              (click)="toggleSidebar()"
              class="futuristic-sidebar-link"
            >
              <i class="fas fa-user futuristic-sidebar-icon-fa"></i>
              Mon Profil
            </a>

            <a
              (click)="logout(); toggleSidebar()"
              class="futuristic-sidebar-link cursor-pointer"
            >
              <i class="fas fa-sign-out-alt futuristic-sidebar-icon-fa"></i>
              Déconnexion
            </a>
          </ng-container>
        </nav>
      </div>
    </div>
  </div>

  <!-- Contenu principal futuriste -->
  <main class="pt-16 pb-12 futuristic-main-content">
    <!-- Message de statut futuriste -->
    <div
      *ngIf="messageFromRedirect"
      class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"
    >
      <div class="futuristic-status-message mb-6">
        <div class="flex items-center">
          <i class="fas fa-info-circle futuristic-status-icon"></i>
          <p class="ml-3 text-sm font-medium futuristic-status-text">
            {{ messageFromRedirect }}
          </p>
        </div>
      </div>
    </div>

    <!-- Router outlet -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <router-outlet></router-outlet>
    </div>
  </main>
</div>
