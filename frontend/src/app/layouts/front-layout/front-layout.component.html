
<header class="fixed top-0 left-0 right-0 bg-white shadow-md z-50 flex items-center justify-between px-6 py-3">
  <div class="flex items-center">
    <button 
      (click)="toggleSidebar()" 
      class="mr-4 text-gray-700 lg:hidden focus:outline-none"
      aria-label="Toggle menu"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
    <h1 class="text-2xl font-bold text-[#4f5fad]">DevBridge</h1>
    <span class="ml-2 text-sm text-gray-500 hidden md:block">Project Management Suite</span>
  </div>

  <nav class="hidden md:flex space-x-6">
    <a 
      routerLink="/" 
      class="text-gray-700 hover:text-[#7826b5] transition-colors" 
      routerLinkActive="text-[#7826b5] font-medium"
    >
      Accueil
    </a>
  </nav>


  <div *ngIf="authService.userLoggedIn(); else authButtons" class="flex items-center space-x-4">
    <div class="relative ml-4 flex items-center md:ml-6">
      <div class="relative">
        <button 
          (click)="toggleProfileMenu()" 
          class="max-w-xs flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-[#dac4ea]"
          aria-label="Profile menu"
        >
          <span class="sr-only">Open user menu</span>
          <span class="hidden md:inline-block mr-2 text-sm font-medium text-[#6d6870]">{{ currentUser?.username }}</span>
          <div class="relative">
            <img 
              [src]="profileImage || 'assets/default-profile.png'" 
              alt="Profile photo" 
              class="w-8 h-8 rounded-full object-cover border-2 border-[#4f5fad]"
            >
            <div class="absolute -bottom-1 -right-1 bg-green-500 rounded-full w-3 h-3 border-2 border-white"></div>
          </div>
        </button>


        <div 
          *ngIf="profileMenuOpen" 
          class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50"
          @fadeInOut
        >
          <a 
            routerLink="/profile" 
            (click)="profileMenuOpen = false" 
            class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
          >
            Mon profil
          </a>
          <div class="border-t border-gray-100 px-4 py-2">
            <label class="block text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">
              Changer de photo
              <input 
                type="file" 
                (change)="handleProfileImage($event)" 
                accept="image/*" 
                class="hidden"
              >
            </label>
          </div>
          <a 
            (click)="logout()" 
            class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer"
          >
            Déconnexion
          </a>
        </div>
      </div>
    </div>
  </div>

  <ng-template #authButtons>
    <div class="flex space-x-4">
      <a routerLink="/loginuser" class="px-3 py-1 text-[#4f5fad] hover:text-[#7826b5]">Connexion</a>
      <a routerLink="/registeruser" class="px-3 py-1 bg-[#4f5fad] text-white rounded hover:bg-[#7826b5]">Inscription</a>
    </div>
  </ng-template>
</header>
<!-- Mobile sidebar -->
<nav 
  class="fixed top-0 left-0 h-full w-72 bg-[#4f5fad] text-white font-bold p-6 z-40 transform transition-all duration-300 ease-in-out lg:hidden"
  [class.translate-x-0]="sidebarOpen"
  [class.-translate-x-full]="!sidebarOpen"
  [attr.aria-hidden]="!sidebarOpen"
>
  <div class="flex justify-between items-center mb-10">
    <div>
      <h3 class="text-2xl font-extrabold">DevBridge</h3>
      <p class="text-[#dac4ea] text-sm">Project Management Suite</p>
    </div>
    <button 
      (click)="toggleSidebar()" 
      class="text-white text-2xl focus:outline-none"
      aria-label="Close menu"
    >
      &times;
    </button>
  </div>

  <div class="space-y-2">
    <a 
      routerLink="/" 
      (click)="toggleSidebar()" 
      class="flex items-center gap-3 hover:bg-[#7826b5] px-4 py-3 rounded transition-all"
    >
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
      </svg>
      Accueil
    </a>

    <ng-container *ngIf="!authService.userLoggedIn()">
      <a 
        routerLink="/loginuser" 
        (click)="toggleSidebar()" 
        class="flex items-center gap-3 hover:bg-[#7826b5] px-4 py-3 rounded transition-all"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
        </svg>
        Connexion
      </a>

      <a 
        routerLink="/registeruser" 
        (click)="toggleSidebar()" 
        class="flex items-center gap-3 hover:bg-[#7826b5] px-4 py-3 rounded transition-all"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
        </svg>
        Inscription
      </a>
    </ng-container>

    <ng-container *ngIf="authService.userLoggedIn()">
      <a 
        routerLink="/profile" 
        (click)="toggleSidebar()" 
        class="flex items-center gap-3 hover:bg-[#7826b5] px-4 py-3 rounded transition-all"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
        </svg>
        Mon Profil
      </a>

      <a 
        (click)="logout(); toggleSidebar()" 
        class="flex items-center gap-3 hover:bg-[#7826b5] px-4 py-3 rounded transition-all cursor-pointer"
      >
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
        </svg>
        Déconnexion
      </a>
    </ng-container>
  </div>
</nav>

<!-- Mobile sidebar overlay -->
<div 
  *ngIf="sidebarOpen" 
  class="fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden" 
  (click)="toggleSidebar()"
></div>

<!-- Main content -->
<main class="pt-16 px-4 md:px-6 min-h-screen bg-[#edf1f4]">
  <div 
    *ngIf="messageFromRedirect" 
    class="p-4 bg-yellow-100 text-yellow-800 rounded mb-4 text-center"
  >
    {{ messageFromRedirect }}
  </div>
  <router-outlet></router-outlet>
</main>



